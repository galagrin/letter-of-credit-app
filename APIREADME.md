### Документация API

#### **Аутентификация (`/api/auth`)**

Управляется библиотекой `next-auth`.

-   **Регистрация нового пользователя**

    -   **Эндпоинт:** `POST /api/users`
    -   **Описание:** Создает нового пользователя. Доступен всем.
    -   **Тело запроса (JSON):**
        ```json
        {
            "email": "user@example.com",
            "password": "strongpassword123",
            "name": "John Doe" // опционально
        }
        ```
    -   **Ответы:**
        -   `201 Created`: JSON с данными пользователя (без хеша пароля).
        -   `400 Bad Request`: Неверные данные (например, невалидный email).
        -   `409 Conflict`: Пользователь с таким email уже существует.

-   **Вход в систему**

    -   **Эндпоинт:** `POST /api/auth/callback/credentials`
    -   **Описание:** Аутентифицирует пользователя и устанавливает сессионную cookie.
    -   **Тело запроса (x-www-form-urlencoded):**
        -   `email`: `user@example.com`
        -   `password`: `strongpassword123`
        -   `csrfToken`: (требуется при вызове не из браузера)
    -   **Ответы:**
        -   `302 Found` (редирект на `/`) и `Set-Cookie` с `next-auth.session-token` при успехе.
        -   `302 Found` (редирект на `/api/auth/signin`) при неудаче.

-   **Выход из системы**

    -   **Эндпоинт:** `POST /api/auth/signout`
    -   **Описание:** Завершает сессию пользователя.
    -   **Тело запроса:** Пустое (требуется `csrfToken`, если вызывается из JS).
    -   **Ответы:**
        -   `302 Found` (редирект на `/`) и удаление сессионных cookie.

-   **Получение данных сессии**
    -   **Эндпоинт:** `GET /api/auth/session`
    -   **Описание:** Возвращает данные текущей сессии.
    -   **Ответы:**
        -   `200 OK`: JSON с объектом сессии (включая `user.id`, `user.role`).
        -   `200 OK`: Пустой объект `{}` если сессии нет.

---

#### **Банки (`/api/banks`)**

-   **Получить список всех банков**

    -   **Эндпоинт:** `GET /api/banks`
    -   **Защита:** Требуется любая аутентификация.
    -   **Ответы:**
        -   `200 OK`: Массив объектов банков `[{"id": 1, "name": "...", ...}]`.
        -   `401 Unauthorized`: Если пользователь не залогинен.

-   **Создать новый банк**

    -   **Эндпоинт:** `POST /api/banks`
    -   **Защита:** Требуется роль `ADMIN`.
    -   **Тело запроса (JSON):**
        ```json
        {
            "name": "Новый СуперБанк",
            "country": "Россия",
            "BIC": "044525225", // опционально
            "SWIFT": "SABRRUMM" // опционально
        }
        ```
    -   **Ответы:**
        -   `201 Created`: JSON с данными созданного банка.
        -   `403 Forbidden`: Если у пользователя нет прав админа.
        -   `409 Conflict`: Если банк с таким `name`, `BIC` или `SWIFT` уже существует.

-   **Обновить банк**

    -   **Эндпоинт:** `PUT /api/banks/{id}` (например, `/api/banks/1`)
    -   **Защита:** Требуется роль `ADMIN`.
    -   **Тело запроса (JSON):** Любые поля, которые нужно обновить.
    -   **Ответы:**
        -   `200 OK`: JSON с обновленными данными банка.
        -   `404 Not Found`: Если банк с таким `id` не найден.

-   **Удалить банк**
    -   **Эндпоинт:** `DELETE /api/banks/{id}`
    -   **Защита:** Требуется роль `ADMIN`.
    -   **Ответы:**
        -   `204 No Content`: Успешное удаление (тело ответа пустое).
        -   `404 Not Found`: Если банк с таким `id` не найден.

---

#### **Компании (`/api/companies`)**

_API для компаний полностью аналогично API для банков (GET, POST, PUT, DELETE) со своими полями (`name`, `taxId`, `country`)._

---

#### **Аккредитивы (`/api/lcs`)**

-   **Получить список всех аккредитивов**

    -   **Эндпоинт:** `GET /api/lcs`
    -   **Защита:** Требуется любая аутентификация.
    -   **Ответы:**
        -   `200 OK`: Массив объектов аккредитивов, с **вложенными** объектами `applicant`, `beneficiary`, `issuingBank`.

-   **Создать новый аккредитив**

    -   **Эндпоинт:** `POST /api/lcs`
    -   **Защита:** Требуется любая аутентификация.
    -   **Тело запроса (JSON):**
        ```json
        {
            "amount": 10000.0,
            "currency": "RUB",
            "issueDate": "2025-01-01T00:00:00.000Z",
            "expiryDate": "2025-03-31T23:59:59.000Z",
            "applicantId": 1, // ID существующей компании
            "beneficiaryId": 2, // ID существующей компании
            "issuingBankId": 1 // ID существующего банка
            // ... другие опциональные поля ...
        }
        ```
    -   **Ответы:**
        -   `201 Created`: JSON с данными созданного аккредитива.
        -   `404 Not Found`: Если один из указанных `id` (банка или компании) не найден.

-   **Обновить/Удалить аккредитив**
    -   **Эндпоинты:** `PUT /api/lcs/{id}`, `DELETE /api/lcs/{id}`
    -   **Защита:** Разрешено только **владельцу** аккредитива или пользователю с ролью `ADMIN`.
